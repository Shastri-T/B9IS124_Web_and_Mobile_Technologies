<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="icon" href="./media/icon.png">
    <meta name="viewport" content="width=device-width">
    <title>Irish Fitness Factory</title>    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./CSS/webstyle.css" media="screen and (min-width: 680px)">
    <link rel="stylesheet" href="./CSS/mobilestyle.css" media="screen and (max-width: 680px)">    
</head>

<!--
    **********************************************************************************************************************************************************************
    **********************************BEGINNING OF BODY TAG***********************************************************************************************************************************
    **********************************************************************************************************************************************************************
-->

<body>
    <div class="container">
        <div class="logo" onclick="NavigateHome()"></div>
        <a href="./product.html?checkout=true">
            <div class="cart"><span id="cartcount"></span></div>
        </a>

        <div class="nav">
            <div class="nav-links">
                <ul class="navLinks">
                    <li class="icon">
                        <a href="javascript:void(0);" style="font-size:15px;" onclick="myFunction()">☰</a></li>
                </ul>
            </div>
        </div>


        <div class="hm-middle">
            <form id="form-searchbar" class="searchbar-form">

                <div class="searchbar-operate-box">
                    <input type="submit" class="search-button" value="">
                </div>

                <div class="search-key-box">
                    <input type="text" id="productsearch" placeholder="search the fitness factory" maxlength="50"
                        value="" name="SearchText" class="search-key" id="search-key">
                </div>
            </form>
        </div>
    </div>

    <div class="main">
        <ul id="productcatalog" class="cards">
        </ul>
    </div>


    <!--
    **********************************************************************************************************************************************************************
    **********************************BEGINNING OF SCRIPT TAG***********************************************************************************************************************************
    **********************************************************************************************************************************************************************
    -->

    <script src="./JS/main.js"></script>

    <script>
        $(document).ready(function () {
            cartitemshtml = "";
            if (localStorage.getItem("cartitems")) {

                //var qs = document.location.href.split('?checkout=true')[1];
                var qs = localStorage.getItem("cartitems");
                var parts = qs.split('&');
                var arr = [];
                itemslist = [];
                qtylist = [];
                product_name = "";
                product_price = "";
                totalprice = 0;

                $.each(parts, function () {
                    var val = this.split('=')[1];
                    arr.push(val);
                }); 
                //console.log(arr);
                for (var i = 0; i < arr.slice(1).length; i++) {
                    itemslist.push(arr.slice(1)[i].split(':')[0]);
                    qtylist.push(arr.slice(1)[i].split(':')[1]);
                }

                $("#cartcount").text(itemslist.length);

                for (var i = 0; i < itemslist.length; i++) {
                    product_name = products_list.filter(function (data) {
                        return data.id == String(itemslist[i]);
                    })[0].name;

                    product_price = products_list.filter(function (data) {
                        return data.id == String(itemslist[i]);
                    })[0].price;

                    cartitemshtml += "<br/><div><a id='productlink' href='#'>" + product_name + " (" + qtylist[i] + ")</a> <span class='price'>" + parseInt(qtylist[i]) * parseInt(product_price.split('€')[1].trim()) + "</span></div><br/>";
                    totalprice += parseInt(qtylist[i]) * parseInt(product_price.split('€')[1].trim());
                }

                $("#cartitems").append(cartitemshtml);
                $('.totalprice').html(totalprice);
            }

            else {
                $(".row").hide();
                $(".cartmsg").show();
            }
        });
    </script>
</body>
</html>